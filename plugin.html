<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>js插件编写说明</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">

				<!-- Header -->
				<header id="header">
					<a href="index.html" class="logo">autMan</a>
					<ul class="icons">
						<li><a href="https://github.com/hdbjlizhe/fanli" class="icon brands fa-github"><span
									class="label">Github</span></a></li>
						<li><a href="tencent://message/?uin=282617666&Site=&Menu=yes" target="_blank" title="点击添加群主"
								class="icon brands fa-qq"><span class="label">QQ</span></a></li>
						<li><a href="#" class="icon brands fa-telegram"><span class="label">Telegram</span></a></li>
					</ul>
				</header>

				<!--页面内目录-->
				<section>
					<p><b>本页面目录</b></p>
					<div><a href="#1.头标注">1.头标注</a></div>
					<div><a href="#2.内联函数">2.内联函数</a></div>
				</section>

				<!-- Content -->
				<section>
					
					<h2><a id="1.头标注"></a>1.头标注</h2>
					<!-- Content -->
					<pre><code>//[event: 事件] 这里响应事件，事件列表见下文
//[rule: 规则] 匹配规则，多个规则时向下依次写多个[rule:规则]
//[cron: 定时] cron定时，如：*/1 * * * *，推荐5位域，秒位可选，6位位域也可但可能存在部分系统不兼容问题
//[admin: true或false] 是否为管理员指令 
//[disable: true或false] 禁用开关，true表示禁用，false表示可用
//[priority: 123] 优先级，数字越大表示优先级越高
//[server: xxx] 
//[show: 插件说明] 自定义插件说明
//[imType:qq,wx] 白名单,只在qq,wx生效
//[imType+:qq,wx] 同上,不写+号默认为白名单模式
//[imType-:qq] 黑名单qq,除了qq生效
//[userId+:id1,id2] 同样支持黑白名单模式
//[groupId+:id1,id2] 同样支持黑白名单模式
</code></pre>

以下为上传云插件所需的头注
<pre><code>//[tile: 名字]要与文件名相同，也可以不加，上传aut云时会自动将文件名设置为此头注
//[author: 作者]作者,可以自定义，不定义的话，上传时会增加为aut云注册的用户名
//[version: 1.0.0] 版本格式：1.0.0，不定义的话，上传时会自动增加此头注，默认为1.0.0 
//[platform: qq,wx,tg]适用的平台 qq\wx\tg\wxmp之间选择，中间用英文逗号隔开
//[public: true] 是否公开发布？值为true 或 false，不定义的话，上传aut云时会自动设置为true
//[price: 0.5] 上架价格
//[description: 关于插件的描述] 尽量写具体
</code></pre>

					<h2><a id="2.内联函数"></a>1.内联函数</h2>
					<pre><code>
call(param)//参数有machineId(获取机器码),uuid(生成随机uuid),md5(对字符串计算md5),timeFormat(定义时间格式))
cancall(param)//检查是否可调用某函数，返回布尔值

//网络请求函数
request({
	useproxy: true/false,//是否使用代理
	url: "xxx",//地址
	headers:{//请求头
		"User-Agent":"xxx"
		"Content-Type":"xxx"
	},
	method: "post",//网络请求方法get,post,put,delete
	dataType: "json",//数据类型json(json数据类型)、location(跳转页)
	body:{//请求体
		code: xxx,
	},
	formData:{//请求参数
		key1: xxx,
		key1: xxx,
		key1: xxx,
		key1: xxx,
	},
	timeOut: //单位为毫秒ms
}function(error,response,header,body){
	//网络请求处理函数
})
//另一种使用方式
body=request()
//信息推送函数
push(
	{
		imType: 'qq',
		groupCode: 'xxxxxxxx'或者chatID: 'xxxxxxxx',
		userID: 'xxxxxxx',
		content: 'xxxxxxxx',
	}
)
waitPay(timeout)//等待微信支付（支持微信赞赏码、微信收款码、微信转账，暂不支持微信红包）,timeout为超时时间，单位毫秒
Delete()//删除用户信息

//以下为时间函数参数sec为unix秒数，nsec为纳秒，后面的时间格式yyyy为年，MM为月份，dd为日期，hh为12小时制，HH为24小时制，mm为分，ss为秒，如："yyyy-MM-dd hh:mm:ss"
timeFmt(format)//按照format格式输出前时间
unixTimeFmt(sec,nsec,format)//按照format格式输入unix时间

GetUserID()//获取当前会话用户ID
GetContent()//获取当前会话用户发的信息内容
GetChatID()//获取当前会话群ID
GetImType()//获取当前会话的渠道，返回qq,wx等
ImType()//同上
GetUsername()//获取当前会话用户名
GetChatname()//获取当前会话群名称
GetMessageID()//获取当前信息ID
GetMessageByID(id)//通过信息id获取最近的消息
RecallMessage(messageID)//撤回信息，参数为信息id
notifyMasters(content)//将信息发送给管理员
input(waitTime,recallTime,"group")//等待用户输入，参数为等待时间（单位毫秒），返回用户输入的信息
使用样例：
msg=input(60000)//表示等待用户输入，等待用户输入时间为60秒
msg=input(60000,60000)//表示等待用户输入（60秒），用户输入后60秒撤回，recallTime为0表示不撤回
msg=input(60000,60000,"group")//表示等待群内任意用户的输入

breakIn(content)//将信息送入内部格式对应的处理通道进行处理
Debug()//输出调试信息
GroupKick(userid,reject_add_request)//踢群，参数分别为用户id,是否拒绝再次加群请求
GroupBan(userid,duration)//禁言，参数分别为用户id,时长
sleep(waitTime)//睡眠一段时间，单位毫秒
isAdmin()//返回当前会话是否为管理员
set(key,value)//存储key,value
param(integer)//获取匹配规则里规定的第几个匹配值
get(key)//获取otto桶key的值
bucketGet(bucket,key)//获取bucket桶的key值
bucketKeys(value)//通过值反查key，返回的是key的数组
bucketAllKeys(bucket)//获取桶内所有的key
bucketSet(bucket,key,value)//设置bucket桶的key的值为value
bucketDel(bucket,key)//删除bucket桶的key值
sendText(text)//给会话用户发送信息
image(url)//将图片url转换为CQ码格式
sendImage(url)//发送图片，参数为网址
sendVideo(url)//发送视频
Sender//当前会话的Sender模块
fmt//控制台输出信息模块
strings//字符串模块
require("xx")//引入nodejs模块（需要主机安装nodejs）
importFs(filepath)//读取文件
importJs(filepath)//引入js文件，参数为文件路径
importDir(dir)//引入js文件夹，参数为路径
</code></pre>
					<pre><code>以下为部分事件的对应表
	/////////////////////////QQ类事件//////////////////////////////////////////////////////
	//元数据类
	"qq-meta_event-lifecycle-connect": "QQ完成连接",
	"qq-meta_event-lifecycle-enable":  "QQ开始工作",
	"qq-meta_event-lifecycle-disable": "QQ连接失效",
	"qq-meta_event-heartbeat":"ws连接心跳事件"
	//通知类
	"qq-notice-group_increase": "QQ有人加群",
	"qq-notice-group_decrease": "QQ有人退群",

	"qq-notice-group_decrease-leave":   "QQ群有人主动退群",
	"qq-notice-group_decrease-kick":    "QQ群成员被踢",
	"qq-notice-group_decrease-kick_me": "QQ群成员登录号被踢",

	"qq-notice-group-recall":       "QQ群内消息撤回", //{"self_id":363586159,"time":1670485977,"post_type":"notice","notice_type":"group","sub_type":"recall","group_id":825897018,"user_id":79873111,"operator_id":79873111,"message_id":"MTowOgTCxFcAANg4WKS9z2ORl9cB"}
	"qq-notice-friend_recall":      "QQ好友私聊消息撤回",
	"qq-notice-group_admin-set":    "设置群管理员",
	"qq-notice-group_admin_unset":  "取消管理员",
	"qq-notice-group_upload":       "群文件上传",
	"qq-notice-group_ban-ban":      "群禁言",
	"qq-notice-group_ban-lift_ban": "解除禁言",
	//请求类
	"qq-request-friend-single": "QQ有人请求加机器人为好友", //{"self_id":363586159,"time":1670977881,"post_type":"request","request_type":"friend","sub_type":"single","user_id":3554541945,"nickname":"winBBA","source":"QQ号查找","comment":"","sex":"unknown","age":0,"flag":"~d3de01795efbedb064840"}
	"qq-request-group-add":     "QQ请求加群",

	/////////////////////////微信类事件//////////////////////////
	"wx-received-sent-pay": "微信机器人收到或发送支付（含转账、赞赏码、收款码）",
</code></pre>
				</section>

			</div>
		</div>

		<!-- Sidebar -->
		<div id="sidebar">
			<div class="inner">
				<include src="sidebar.html"></include>
			</div>
		</div>

	</div>

	<!-- Scripts -->
	<script src="assets/js/include.js"></script>
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

</body>

</html>
